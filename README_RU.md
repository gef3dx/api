# Backend-проект на FastAPI

Это бэкенд-сервис на FastAPI, реализованный по шаблону архитектуры «репозиторий/сервис». Система реализует аутентификацию пользователей, управление профилями, систему уведомлений и управление доступом на основе ролей (RBAC) с использованием современных инструментов Python и лучших практик.

## Функциональность

*   **Аутентификация пользователей** с помощью JWT-токенов
*   **Система управления профилями**
*   **Система уведомлений** с возможностью работы в реальном времени
*   **Система приватных сообщений** между пользователями
*   **Управление доступом на основе ролей (RBAC)** (клиент, исполнитель, администратор)
*   **Сброс пароля** с подтверждением по email
*   **Миграции базы данных** с помощью Alembic
*   **Внедрение зависимостей** с помощью Dishka

## Технологический стек

*   **Фреймворк:** FastAPI (Python 3.11+)
*   **ASGI-сервер:** Uvicorn
*   **База данных:** SQLite с SQLAlchemy 2.0 (AsyncSession)
*   **Миграции:** Alembic
*   **Внедрение зависимостей:** Dishka
*   **Валидация данных:** Pydantic v2
*   **Безопасность:** Passlib (bcrypt/argon2), PyJWT
*   **Email:** aiosmtplib
*   **Конфигурация:** python-dotenv
*   **Тестирование:** pytest, httpx, pytest-asyncio
*   **Качество кода:** ruff, black, mypy

## Структура проекта

```
app/
  core/
    config.py          # Конфигурация приложения
    security.py        # Хеширование и проверка паролей
    jwt.py             # Создание и валидация JWT-токенов
    email.py           # Функциональность отправки email
  db/
    base.py            # Базовые модели базы данных
    session.py         # Управление сессиями базы данных
  domain/
    users/
      models.py        # Модель пользователя в БД
      schemas.py       # Pydantic-схемы для пользователя
      repository.py    # Слой доступа к данным пользователя (репозиторий)
      service.py       # Бизнес-логика пользователя (сервис)
      router.py        # API-эндпоинты пользователя
      enums.py         # Перечисления, связанные с пользователем
      policies.py      # Политики доступа для пользователя
    profiles/
      models.py        # Модель профиля в БД
      schemas.py       # Pydantic-схемы для профиля
      repository.py    # Слой доступа к данным профиля (репозиторий)
      service.py       # Бизнес-логика профиля (сервис)
      router.py        # API-эндпоинты профиля
    auth/
      router.py        # API-эндпоинты аутентификации
      schemas.py       # Pydantic-схемы для аутентификации
      service.py       # Бизнес-логика аутентификации (сервис)
      repository.py    # Слой доступа к данным аутентификации (репозиторий)
    notifications/
      models.py        # Модель профиля в БД уведомления
      schemas.py       # Pydantic-схемы для уведомления
      repository.py    # Слой доступа к данным уведомления (репозиторий)
      service.py       # Бизнес-логика уведомления (сервис)
      router.py        # API-эндпоинты уведомления
      enums.py         # Перечисления, связанные с уведомлением
    messages/
      models.py        # Модель профиля в БД сообщения
      schemas.py       # Pydantic-схемы для сообщения
      repository.py    # Слой доступа к данным сообщения (репозиторий)
      service.py       # Бизнес-логика сообщения (сервис)
      router.py        # API-эндпоинты сообщения
  di/
    container.py       # Контейнер для внедрения зависимостей
  api/
    deps.py            # Зависимости API
    router.py          # Все API-эндпоинты 
  utils/
    crypto.py          # Криптографические утилиты
    exceptions.py      # Пользовательские исключения
  main.py              # Точка входа в приложение
alembic/
  env.py               # Конфигурация Alembic
  versions/            # Скрипты миграции базы данных
docs/                  # Документация
scripts/               # Скрипты для разработки
tests/
  test_auth.py         # Тесты аутентификации
  test_users.py        # Тесты функциональности пользователя
  test_profiles.py     # Тесты функциональности профиля
  test_notifications.py # Тесты функциональности уведомлений
  test_messages.py     # Тесты функциональности сообщений
.env.example           # Пример файла переменных окружения
```

